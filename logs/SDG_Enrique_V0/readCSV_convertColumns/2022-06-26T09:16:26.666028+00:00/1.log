[2022-06-26 09:16:47,160] {taskinstance.py:851} INFO - Dependencies all met for <TaskInstance: SDG_Enrique_V0.readCSV_convertColumns 2022-06-26T09:16:26.666028+00:00 [queued]>
[2022-06-26 09:16:47,195] {taskinstance.py:851} INFO - Dependencies all met for <TaskInstance: SDG_Enrique_V0.readCSV_convertColumns 2022-06-26T09:16:26.666028+00:00 [queued]>
[2022-06-26 09:16:47,196] {taskinstance.py:1042} INFO - 
--------------------------------------------------------------------------------
[2022-06-26 09:16:47,197] {taskinstance.py:1043} INFO - Starting attempt 1 of 1
[2022-06-26 09:16:47,198] {taskinstance.py:1044} INFO - 
--------------------------------------------------------------------------------
[2022-06-26 09:16:47,208] {taskinstance.py:1063} INFO - Executing <Task(PythonOperator): readCSV_convertColumns> on 2022-06-26T09:16:26.666028+00:00
[2022-06-26 09:16:47,216] {standard_task_runner.py:52} INFO - Started process 10992 to run task
[2022-06-26 09:16:47,222] {standard_task_runner.py:76} INFO - Running: ['airflow', 'tasks', 'run', 'SDG_Enrique_V0', 'readCSV_convertColumns', '2022-06-26T09:16:26.666028+00:00', '--job-id', '199', '--pool', 'default_pool', '--raw', '--subdir', 'DAGS_FOLDER/company_forecasting.py', '--cfg-path', '/tmp/tmp4pt3xbys', '--error-file', '/tmp/tmpox56rgua']
[2022-06-26 09:16:47,225] {standard_task_runner.py:77} INFO - Job 199: Subtask readCSV_convertColumns
[2022-06-26 09:16:47,279] {logging_mixin.py:104} INFO - Running <TaskInstance: SDG_Enrique_V0.readCSV_convertColumns 2022-06-26T09:16:26.666028+00:00 [running]> on host 5e8dc4b25004
[2022-06-26 09:16:47,328] {taskinstance.py:1257} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_EMAIL=enrique-liebana@outlook.com
AIRFLOW_CTX_DAG_OWNER=Enrique
AIRFLOW_CTX_DAG_ID=SDG_Enrique_V0
AIRFLOW_CTX_TASK_ID=readCSV_convertColumns
AIRFLOW_CTX_EXECUTION_DATE=2022-06-26T09:16:26.666028+00:00
AIRFLOW_CTX_DAG_RUN_ID=manual__2022-06-26T09:16:26.666028+00:00
[2022-06-26 09:16:50,613] {logging_mixin.py:104} WARNING - /home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py:1315 DtypeWarning: Columns (46,56,59) have mixed types.Specify dtype option on import or set low_memory=False.
[2022-06-26 09:16:50,947] {logging_mixin.py:104} INFO -   rev_mean mou_mean totmrc_mean  ... creditcd eqpdays customer_id
0  23,9975   219,25        22,5  ...        Y   361.0     1000001
1  57,4925   482,75      37,425  ...        Y   240.0     1000002
2    16,99    10,25       16,99  ...        Y  1504.0     1000003
3       38      7,5          38  ...        Y  1812.0     1000004
4    55,23    570,5       71,98  ...        Y   434.0     1000005

[5 rows x 100 columns]
[2022-06-26 09:16:50,949] {logging_mixin.py:104} INFO - rev_mean        object
mou_mean        object
totmrc_mean     object
da_mean         object
ovrmou_mean     object
                ...   
kid11_15        object
kid16_17        object
creditcd        object
eqpdays        float64
customer_id      int64
Length: 100, dtype: object
[2022-06-26 09:16:50,950] {logging_mixin.py:104} INFO - **************** FLOAT COLUmNS *********************
[2022-06-26 09:16:58,438] {logging_mixin.py:104} INFO -    rev_mean  mou_mean  totmrc_mean  da_mean  ...  avgrev  avgmou  avgqty  hnd_price
0   23.9975    219.25       22.500   0.2475  ...   29.66   83.37   32.69  149.98999
1   57.4925    482.75       37.425   0.2475  ...   51.53  479.40  265.89        NaN
2   16.9900     10.25       16.990   0.0000  ...   34.54  433.98  140.86   29.98999
3   38.0000      7.50       38.000   0.0000  ...   40.45   63.23   30.81   29.98999
4   55.2300    570.50       71.980   0.0000  ...   38.69  249.38   79.50  149.98999

[5 rows x 56 columns]
[2022-06-26 09:16:58,439] {logging_mixin.py:104} INFO - **************** OBJECT COLUmNS *********************
[2022-06-26 09:16:58,906] {logging_mixin.py:104} INFO - ************+***********RESULTS*****************************
[2022-06-26 09:16:58,922] {logging_mixin.py:104} INFO - FLOAT64 (100000, 69)
[2022-06-26 09:16:58,926] {logging_mixin.py:104} INFO - INT64 (100000, 10)
[2022-06-26 09:16:58,929] {logging_mixin.py:104} INFO - STRING (100000, 21)
[2022-06-26 09:16:59,034] {logging_mixin.py:104} INFO -    rev_mean  mou_mean  totmrc_mean  ...  creditcd  eqpdays  customer_id
0   23.9975    219.25       22.500  ...         Y    361.0      1000001
1   57.4925    482.75       37.425  ...         Y    240.0      1000002
2   16.9900     10.25       16.990  ...         Y   1504.0      1000003
3   38.0000      7.50       38.000  ...         Y   1812.0      1000004
4   55.2300    570.50       71.980  ...         Y    434.0      1000005

[5 rows x 100 columns]
[2022-06-26 09:17:17,377] {base.py:74} INFO - Using connection to: id: postgres_conection. Host: host.docker.internal, Port: 5432, Schema: data_company, Login: airflow, Password: XXXXXXXX, extra: None
[2022-06-26 09:17:17,395] {logging_mixin.py:104} INFO - CREATE TABLE IF NOT EXISTS company_0A1(rev_mean REAL, 
mou_mean REAL, 
totmrc_mean REAL, 
da_mean REAL, 
ovrmou_mean REAL, 
ovrrev_mean REAL, 
vceovr_mean REAL, 
datovr_mean REAL, 
roam_mean REAL, 
change_mou REAL, 
change_rev REAL, 
drop_vce_mean REAL, 
drop_dat_mean REAL, 
blck_vce_mean REAL, 
blck_dat_mean REAL, 
unan_vce_mean REAL, 
unan_dat_mean REAL, 
plcd_vce_mean REAL, 
plcd_dat_mean REAL, 
recv_vce_mean REAL, 
recv_sms_mean REAL, 
comp_vce_mean REAL, 
comp_dat_mean REAL, 
custcare_mean REAL, 
ccrndmou_mean REAL, 
cc_mou_mean REAL, 
inonemin_mean REAL, 
threeway_mean REAL, 
mou_cvce_mean REAL, 
mou_cdat_mean REAL, 
mou_rvce_mean REAL, 
owylis_vce_mean REAL, 
mouowylisv_mean REAL, 
iwylis_vce_mean REAL, 
mouiwylisv_mean REAL, 
peak_vce_mean REAL, 
peak_dat_mean REAL, 
mou_peav_mean REAL, 
mou_pead_mean REAL, 
opk_vce_mean REAL, 
opk_dat_mean REAL, 
mou_opkv_mean REAL, 
mou_opkd_mean REAL, 
drop_blk_mean REAL, 
attempt_mean REAL, 
complete_mean REAL, 
callfwdv_mean REAL, 
callwait_mean REAL, 
churn INT4, 
months INT4, 
uniqsubs INT4, 
actvsubs INT4, 
new_cell string, 
crclscod string, 
asl_flag string, 
totcalls INT4, 
totmou REAL, 
totrev REAL, 
adjrev REAL, 
adjmou REAL, 
adjqty INT4, 
avgrev REAL, 
avgmou REAL, 
avgqty REAL, 
avg3mou INT4, 
avg3qty INT4, 
avg3rev INT4, 
avg6mou REAL, 
avg6qty REAL, 
avg6rev REAL, 
prizm_social_one string, 
area string, 
dualband string, 
refurb_new string, 
hnd_price REAL, 
phones REAL, 
models REAL, 
hnd_webcap string, 
truck REAL, 
rv REAL, 
ownrent string, 
lor REAL, 
dwlltype string, 
marital string, 
adults REAL, 
infobase string, 
income REAL, 
numbcars REAL, 
hhstatin string, 
dwllsize string, 
forgntvl REAL, 
ethnic string, 
kid0_2 string, 
kid3_5 string, 
kid6_10 string, 
kid11_15 string, 
kid16_17 string, 
creditcd string, 
eqpdays REAL, 
customer_id INT4);
[2022-06-26 09:17:17,396] {logging_mixin.py:104} INFO - 
[2022-06-26 09:17:17,401] {taskinstance.py:1455} ERROR - type "string" does not exist
LINE 53: new_cell string, 
                  ^
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1112, in _run_raw_task
    self._prepare_and_execute_task_with_callbacks(context, task)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1285, in _prepare_and_execute_task_with_callbacks
    result = self._execute_task(context, task_copy)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1315, in _execute_task
    result = task_copy.execute(context=context)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/operators/python.py", line 117, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/operators/python.py", line 128, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/company_forecasting.py", line 104, in read_and_convertColumns
    cursor.execute(company_0A1)
psycopg2.errors.UndefinedObject: type "string" does not exist
LINE 53: new_cell string, 
                  ^

[2022-06-26 09:17:17,426] {taskinstance.py:1503} INFO - Marking task as FAILED. dag_id=SDG_Enrique_V0, task_id=readCSV_convertColumns, execution_date=20220626T091626, start_date=20220626T091647, end_date=20220626T091717
[2022-06-26 09:17:17,539] {local_task_job.py:146} INFO - Task exited with return code 1
